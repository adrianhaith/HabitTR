% likelihood ratio test to assess all-or-nothing habit model

LLall_2 = nansum([model(2).LLopt(2,:)]); % likelihood of full habit model
LLall_3 = nansum([model(3).LLopt(2,:)]); % likelihood of flex-habit model

Lambda_all = 2*(LLall_3-LLall_2); % likelihood ratio statistic

% compute p-value
%[h,pValue] = lratiotest(Lall_3,Lall_2,1)
p = chi2cdf(Lambda_all,1)

%% individual participants
for s=1:24
    LL_2(s) = [model(2).LLopt(2,s)]; % likelihood of full habit model
    LL_3(s) = [model(3).LLopt(2,s)]; % likelihood of flex-habit model

    Lambda(s) = exp(LL_3(s)-LL_2(s)); % likelihood ratio statistic

% compute p-value
%[h,pValue] = lratiotest(Lall_3,Lall_2,1)
    p2(s) = chi2cdf(Lambda(s),1);
end

%% same for condition 3
% individual participants
for s=1:24
    LL_2_3(s) = [model(2).LLopt(3,s)]; % likelihood of full habit model
    LL_3_3(s) = [model(3).LLopt(3,s)]; % likelihood of flex-habit model

    Lambda3(s) = exp(LL_3_3(s)-LL_2_3(s)); % likelihood ratio statistic

% compute p-value
%[h,pValue] = lratiotest(Lall_3,Lall_2,1)
    p3(s) = chi2cdf(Lambda3(s),1);
    
end

    %ibad = find(model(2).LLopt(3,:)==0);
    %p3(ibad) = NaN;
    
%% same for condition 1
% individual participants
for s=1:24
    LL_2_1(s) = [model(2).LLopt(1,s)]; % likelihood of full habit model
    LL_3_1(s) = [model(3).LLopt(1,s)]; % likelihood of flex-habit model

    Lambda1(s) = exp(LL_3_1(s)-LL_2_1(s)); % likelihood ratio statistic

% compute p-value
%[h,pValue] = lratiotest(Lall_3,Lall_2,1)
    p1(s) = chi2cdf(Lambda1(s),1);
    
end

    %ibad = find(model(2).LLopt(3,:)==0);
    %p3(ibad) = NaN;